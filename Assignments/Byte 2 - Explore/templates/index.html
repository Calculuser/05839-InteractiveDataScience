<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Explore Byte Tutorial</title>
    
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this project -->
    <link href="css/explore.css" rel="stylesheet">
  </head>
  
  <body role="document">
    
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about">About This Data Set</a></li>
	    <li><a href="quality">Data Quality</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    
    <div class="container theme-showcase" role="main">
      
      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
	<h1>Interactive Data Science Project Exploratory Analysis Byte Example</h1>
        <p>This is the Exploratory Analysis Byte of the Interactive Data Science class.</p>
        <p>Data about household heating methods in some cities from Pennsylvania are listed below.</p>
        <p>The table can be found in the following link</p>
        <li><a href="https://fusiontables.google.com/data?docid=1-SIatfbLyAE3PIaGvkdQx7mt35fvjQVCPNzO2VZN#rows:id=1" target="_blank">Household Heating Statistics in Pennsylvania in 2008</a></li>
      </div>
      
      <div class="page-header">
	
      </div> <!-- /page-header -->
    </div> <!-- /container -->
    
    <div class="button-toolbar" role="toolbar" id="headers" name="headers">
      {% for column in columns %}
      <button type="button" class = "btn-space btn btn-info" id="{{column}}" onclick="updateTable('{{column}}')">{{column}}</button>
      {% endfor %}
    </div>
    
    <!--
    <div id="animals"><table id="data" class="table table-striped table-hover">
	<thead class ="thead-inverse">
	  <tr id="cols">
	  </tr>
	</thead>
	<tbody id="rows"> 
	</tbody>
    </table></div>
  -->
  
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="thead-inverse">
       <tr id="cols">
    {% for item in columns %}
             <th>{{ item }}</th>
    {% endfor %}
         </tr>
        </thead>
        <tbody id="rows">
    {% for row in rows %}
         <tr>
      {% for datum in row %}
                <td>{{ datum }} </td>
      {% endfor %}
         </tr>
    {% endfor %}
        </tbody>
     </table>
  </div>
  <section>
	 <h1>Data Cleaning</h1>
	 <p><font size="4">After that, I used the tool Trifacta Wrangler to clean the data. The refined data can be found at the following link.</font></p>
     <li><a href="https://docs.google.com/spreadsheets/d/1A1rAk2Q3GkNS0juTvyNfDO_ccZ5tX054ywp3xJuNE84/edit#gid=1167670942" target="_blank">Household Heating Statistics in Pennsylvania in 2008 (Refined)</a></li>
	 <p></p>
	 <p><font size="4">Lastly, we use the refined dataset to create plots as we did in Byte 1.</font></p>
  </section>
  <section>
	  	<h1>Gas</h1>
	  	<p><font size="4">The following map shows the proportion of residents principally using gas for house heating in every district.</font></p>
		<iframe width="1140" height="700" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?q=select+col12+from+1XHgzMTRILprY3u65bwOWxU8HeIXuReyEl7fZ54gi&amp;viz=MAP&amp;h=false&amp;lat=53.45853109295441&amp;lng=-79.12123711920378&amp;t=1&amp;z=3&amp;l=col12&amp;y=2&amp;tmplt=2&amp;hml=KML"></iframe><p><font size="4">From the map, we can find in most middle and north districts from United States, at least 40% residents choose gas as the principal method for house heating.</font></p>
	  </section>
	  
	  <section>
	    <h1>Electricity</h1>
	  	<p><font size="4">The following map shows the proportion of residents principally using electricity for house heating in every district.</font></p>
		<iframe width="1140" height="700" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?q=select+col12+from+1h9QvOB3-zJ_VgY2_rZns8gfxNdyr5F9gUQ8uHbt7&amp;viz=MAP&amp;h=false&amp;lat=43.32603421788987&amp;lng=-82.30436556862406&amp;t=1&amp;z=3&amp;l=col12&amp;y=5&amp;tmplt=6&amp;hml=KML"></iframe><p><font size="4">From the map, we can find in northwestern and most southern districts from United States, at least 40% residents choose electricity as the principal method for house heating. Especially, in some southeastern districts, the rate exceeds 60% or even 80%.</font></p>
	  </section>
	  
	  <section>
	    <h1>Fuel Oil, Kerosene</h1>
	  	<p><font size="4">The following map shows the proportion of residents principally using fuel oil, kerosene for house heating in every district.</font></p>
		<iframe width="1140" height="700" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?q=select+col3%3E%3E1+from+1yxJ8PZdzYcAn6auexe-lm1iWgOp1xcKmFmvKO_XK&amp;viz=MAP&amp;h=false&amp;lat=58.29732887609514&amp;lng=-107.52331743127297&amp;t=1&amp;z=3&amp;l=col3%3E%3E1&amp;y=4&amp;tmplt=4&amp;hml=KML">
		</iframe>
		<p><font size="4">From the map, we can find in most districts from United States, no more than 20% residents choose fuel oil, kerosene as the principal method for house heating. However, in some northeastern districts, more than 40% residents still prefer fuel oil, kerosene.</font></p>
	  </section>
  
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
	function updateTable(str) {
		console.log("in updateTable");
		console.log(str);

	    // error checking: ignore buttons that don't have a title!
		if (str === "") {
			return;
		}

	    // find the actual button in this document's HTML
		button = document.getElementById(str);
		// for debugging, write its name to the console
		console.log(button.className);
		// check if it is disabled (btn-info)
		if (button.className.includes("btn-info")) {
			// and enable it (btn-primary)
			button.className = "btn btn-space btn-primary";
		} else {
			// otherwise disable it (btn-info)
			button.className = "btn btn-space btn-info";
		}

		// now get all the buttons
		buttons = document.getElementById("headers").children;
		// and collect their names in cols
		cols = [];
		// loop through them
		for (button in buttons) {
			// grab the id (the name we need is there)
			id = buttons[button].id;
			// make sure it isn't null
			if (buttons[button].id != null) {
				// and that the button is selected 
				var isPrimary = buttons[button].className.includes("btn-primary");
				if (isPrimary && (cols.indexOf(id) === -1)) {
					// if so, add it to our array
					cols.push(id);
				}
			}
		}
					
		$.ajax({
			url: '/_update_table',
			dataType: 'json',
			contentType: 'application/json',
			data: JSON.stringify({'cols' : cols}),
			type: 'POST',
			success: function (res, status) {
				console.log("successrunning");
				console.log(res["content"]);
				console.log(res["headers"]);
				var cols = res["headers"];
				var rows = res["content"];

				// get the table, columns and rows
				table = document.getElementById("data");
				headers = document.getElementById("cols");
				body = document.getElementById("rows");

				// delete current contents
				headers.innerHTML='';
				body.innerHTML = '';

				// and put the new information in the table
				for (col in cols) {
					cell = document.createElement("th");
					cell.innerHTML = cols[col];
					headers.appendChild(cell);
				}
				for (row in rows) {
					tr = document.createElement("tr");
					for (item in rows[row]) {
						td = document.createElement("td");
						td.innerHTML = rows[row][item];
						tr.appendChild(td);
					}
					body.appendChild(tr);
				}
			},
			error: function(res, status) {
				// On Error
				alert('error');
			}
		});
	}
				
				   
				   
</script>
</body>
</html>
